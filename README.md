# 아이템매니아

### 정의

- **게임아이템/게임머니/계정**을 **현금**으로 **거래** 할 수 있는 사이트

### 왜 생겼는가? 

- 게임머니로 아이템을 구매하기에는 **아이템의 가치**가 너무 높아 **현금**으로 거래가 필요.
- **거래를 중개**해주는 사이트 생성.
- 사이트는 중개를 통한 거래 **안전성**을 **대가**로 판매금액의 일정금액을 **수수료**로 취함.

### 이용자

- **성인인증**을 받은 이용자들은 자유로운 형식의 제목으로 거래/구매 글을 등록 할 수 있다.


# 이 데이터가 유용한 이유

1. 하루 이용자 **건수가 많고** **게임도 다양**하다. [밑에 참조](https://bit.ly/2DWkbK1)
2. 원래는 현재 상태의 게임시세만 알 수 있다. (그동안의 시세를 보고 판단할 수 있는 데이터가 없다.)
3. 이 데이터를 따라서 **게임시세변동**을 알 수 있다.
4. **현재가 최저가인지 최고가인지 판단**할 수 있게 된다.

> 찾아본 바로는 아직 위와 같은 주제의 자료를 찾지 못했다. 그래서 직접 해보았다.

# 구현방법

1. 우선 **판매자,구매자** 모두 해당 아이템의 **최저가**를 알아야한다.
2. 사이트에서 크롤링 할때 **데이터 분류에 필요한 정보**를 찾는다.
3. **판매하는 방법**에서 **분류**를 하므로 어느 정도까지 분류 되어있는지 찾아본다. [밑에 참조](https://bit.ly/2vIk2oZ)
4. 판매등록에서 **게임명-서버명-물품종류**의 카테고리로 구분되어 있다.
5. 3개의 키워드로 구분하여 데이터를 분류하여 저장.
6. 판매정보에서 얻을 수 있는 정보를 찾는다. [밑에 참조](https://bit.ly/2Jn2eru)
7. **추가적으로 물품제목, 등록일시, 거래번호, 단위금액**을 구할 수 있다.
8. **아이템 목록**과 비교하여 데이터화. (바로 밑에 참조)


# 아이템 목록 
 - Octoparse 사용한 크롤링 [구현방법](https://github.com/chanp5660/Util_chanp5660/tree/master/Octoparse)
 - 아이템목록 [csv](https://github.com/chanp5660/Util_chanp5660/blob/master/Octoparse/ItemList.csv)

# 스케줄링(scheduling)

windows10에 기본 프로그램인 **작업 스케줄러**를 사용해서 매일 반복 시킬 수 있다.

- 여기서 문제가 발생했는데 일반 파일 저장은 가능하나 Rselenium을 사용한 R파일은 작동하지 않았다. Sys.sleep()함수를 이용해서 데이터를 얻었다.
[수정중](https://github.com/chanp5660/BigData/tree/master/chan/R_Task_Scheduler)

#### [실제 코드와 예제](https://github.com/chanp5660/BigData/blob/master/chan/Rcode_example.md)

### 판매공고 올리는 방법

1. 게임-서버-물품종류 선택  

![카테고리](https://user-images.githubusercontent.com/46266247/57274624-c4e27b00-70d6-11e9-8fdb-e1828199c446.JPG)

2. 나머지 사항 작성

![팝니다](https://user-images.githubusercontent.com/46266247/57274715-096e1680-70d7-11e9-8114-cc8a27db12de.JPG)

(유로 서비스 추가시 **문자효과**, **자동재등록**)

![유료](https://user-images.githubusercontent.com/46266247/57274796-55b95680-70d7-11e9-96f1-a9628d29263a.JPG)

### 판매정보

카테고리를 외에도 추가적으로 등록일시, 거래번호

![판매정보](https://user-images.githubusercontent.com/46266247/57275602-ff99e280-70d9-11e9-89bb-e2619ac41430.JPG)


### 이용건수
비인기 게임 한개의 서버에서 5시간 정도 평균 400개 정도의 판매공고가 올라온다.
이후 모든 게임 모든 서버의 하루 이용건수를 구해 추가정보를 넣을 예정 **( 게임 3234개 )**

문제 발생 : 위의 판매등록 방법에서 보면 재등록을  똑같은 사람이 재등록해서 올라온 판매공고를 중복제거해야하는지 인정해야 하는지 구분지어야 함.











# 외부 데이터

외부 데이터 특정 게임 사이트 방문 후 아이템 정보 얻기 (http://maple.inven.co.kr/dataninfo/item/) 이용하여 직업마다 아이템 정보를 얻는다.

![인벤1](https://user-images.githubusercontent.com/46266247/57365920-f9326600-71c0-11e9-8463-f9a85128e26d.PNG)

![인벤](https://user-images.githubusercontent.com/46266247/57365798-b96b7e80-71c0-11e9-8ce0-a9239f36ccd6.PNG)




### 문제

**1. 작성자가 작성한 판매글을 다양하게 입력되어 있다.** #전처리 (굉장히 처리가 어렵다.)

```
    - 정식명칭을 사용하지 않는다.(줄임말, 시즌1＝여름)
    - 세트의 구성품이 일정하지 않다.
    - 아이템명을 순서를 바꾸어 부를 수도 있다.
    
```

**2. 3천원 미만의 가격의 물품은 매니아 거래가 안되는데 묶어서 팜**

```
 => 개별 가격을 알 수 없지만 3000원 안으로 하는 아이템은 사람들이 가격변동에 크게 신경쓰지 않아서 중요한 정보라고 생각하지 않음.
```

**3. 시간이 지남에 따라 가격의 변동이 있는가?**

```
    - 데이터의 시간이 짧아 알아내기는 힘들다. 
    - 명절, 게임 이벤트 기간이 있어야 알 수 있다.
    - 변동이 있다면 현재 아이템의 시세가 낮은지 알 수 있을 것이다.

시간을 두고 데이터가 쌓이면 변동과정을 볼 수 있을 것이다.
그리고 데이터의 양이 적어서 양이 많은 '리니지'게임의 데이터를 얻는 것으로 바꾸었다.
```

**4. 지금 아이템 거래 사이트가 몇개인가?(4개)** (블로그/카페 제외)

```
    - 아이템 매니아
    - 아이템 베이
    - 아이템빌
    - 에어아이템(GS SHOP)[거의 안씀]
    
아이템 거래 사이트의 아이템 가격들은 비슷.(가격 변동이 있을 상황이 비슷하다고 생각.)
실제 판매글이 올라오는 곳이 타 사이트는 아이템 매니아랑 비교할 수 없을 정도로 데이터가 없었다.
따라서 아이템 매니아에서의 거래 데이터만 구해도 된다.
```


**5. 1년 아이템 거래 액수는?** 


```
   2013년에 1조6천 그 이후는 찾는중.
   리니지의 경우 1주일간 거래내용을 보았을 때 한번의 거래로 최고 800만원, 10위로 500만원의 거래가 이루어짐
```

**6. 어떻게 아이템 목록을 얻을 수 있는가?**

```
   보통의 게임은 인벤이라는 곳에서 제공해준다. "크레이지아케이드"라는 게임은 카페에서 얻을 수 있었다.
```

**7. 아이템매니아에 올라온 모든 게임의 판매글을 데이터베이스로 저장**

```
   효과
    - 어떤 게임이 거래수/총거래금액 가장 많은지 비교 가능 -> 아이템매니아가 독점하고 있기 때문에 현금거래량을 추측할 수 있다.
    - 유저가 몇명인지는 파악할 수 없다.
```

**8. 인벤 / 거래게시판**

```
   패치 공지에 있는 사람들의 댓글 분석 -> 언급되는 아이템과 해당 아이템 가격 변동 파악.
   글쓴이의 아이디 알 수 있기 때문에 얼마나 게임을 좋아하고 거래를 자주하는 사람인지 파악 가능.
   아이템매니아 같은 중개사이트를 이용하는 것이 아니라 게임내의 신용도를 바탕으로 계좌이체거래(무통거래)도 많기 때문에 이 곳에서는 무통거래량도 
   파악이 가능하다.
```

**9. 데이터를 언제 마다 어느정도 수집하는 것이 좋겠는가?**

```
   게임마다 상황마다 다르겠지만 
   조건
       1. 기간(이벤트 기간, 게임 다수 유저에게 영향을 미치는 공휴일은 따로 )
       2. 게임의 인기
       
   예를 들어서 
       비인기게임 ‘크레이지아케이드’ 같은 경우 
                               - 평소에 5시간에 한번씩만 돌리면 데이터를 거의 놓치지 않고 얻을 수 있다.
       인기 게임 ‘리니지’ 같은 경우
                               - 2분에 대략 450개.
```

### 목적

**1. 물품별 평균가격 측정**

**2. 최저가 물품 파악**

**3. 제목을 바꾸지 않고 재등록 서비스를 이용하기 때문에 제목에 대한 추정으로 가격을 바꿔서 재등록을 하는지 파악 할 수 있다.**

### EDA

#### 가격에 대한 기초통계량( 평균 , 분산 ) (아이템마다 큰 차이가 있을 수 있음)

현재 상황 (전처리 중, 아이템명과 연결 중)

```
1698열(1:9열[판매글에 대한 속성],10:1698열[아이템명리스트의 속성]
19340행 
```

![그림3](https://user-images.githubusercontent.com/46266247/58577908-8594ed80-8282-11e9-94bd-a4054e07d427.jpg)

##### 아이템매니아 데이터 
- 각게임마다 아이템의 유형차이가 있다.
- 유형 : 
  - 선물식의 가격이 고정된 아이템 가격
  - 가격이 천차만별인 장비 가격
  - 아이템 거래가 제한된 게임에서는 계정 가격
  - 게임-서버-아이템-가격(날짜) = >아이템 가격의 시세변동

### Expansion

1. 현재 게임이 어떤 방향으로 가고 있는가? 

  - 아이템매니아에서는 판매글 수 증감 등으로 상대적 인기 상황 파악.

  - 피시방 점유율도 현상파악에 도움이 됨.(http://www.gametrics.com/ 유료사이트) - [피시방 점유율 변화](https://www.youtube.com/embed/-RY5lnXONX4)

  - 인벤, 갤러리를 통해서 해당 게임에 대한 긍정적인 글과 부정적인 글을 따로 분류해서 비율을 보고 내용을 보고 판단한다.
 

2. 누가 게임으로 밥벌이를 하고 있는가?(거래를 많이 하는 사람 추척)

 - 던전앤파이터 사재기꾼의 사재기 인증 글 
 - 인벤/카페 등 커뮤니티 사이트에서 쓰는 아이디가 인게임 아이디와 같을 확률이 높기 때문에 아이디 추적


3. 자동알림
 - 원하는 가격의 아이템이 판매공고가 올라오면 알려준다.
 - 어플화
